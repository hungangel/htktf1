<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet"
	href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script> 
	 
<!--  <script>
$(document).ready(function(){
	// Activate tooltip
	$('[data-toggle="tooltip"]').tooltip();
	
	// Select/Deselect checkboxes
	var checkbox = $('table tbody input[type="checkbox"]');
	$("#selectAll").click(function(){
		if(this.checked){
			checkbox.each(function(){
				this.checked = true;                        
			});
		} else{
			checkbox.each(function(){
				this.checked = false;                        
			});
		} 
	});
	checkbox.click(function(){
		if(!this.checked){
			$("#selectAll").prop("checked", false);
		}
	});
});
</script>-->
</head>
<body>
	
	<div class="container-xl">
		<div class="table-responsive">
			<div class="table-wrapper">
				<div class="table-title">
					<div class="row">
						<div class="col-sm-3">
							<h2>
							 Hàng hóa
							</h2>
						</div>
						<div  class="col-sm-9" >
                            
                            <a style="float:right" href="#addHangHoaModal" class="btn btn-success" 
							data-dismiss ="modal"	data-toggle="modal"><i class="material-icons" >&#xE147;</i> <span>Thêm hàng hóa</span></a> 
                            
                          
                            <a style="float:right;height:33px" type="submit" class="btn btn-danger" onclick="searchHH()" > Tìm kiếm </a>	
                            
                            <input id="search" type="text" style="width: 250px;display: inline;float:right;float:right;height:33px"
                            name="id"	class="form-control"  placeholder="Search...">

                            
						</div>
							</div>
					</div>
				</div>
				<table id ="listTable" class="table table-striped table-hover">
					<thead>
						<tr>
						
							<th	style="width: 21%">Mã hàng</th>
							<th	style="width: 21%">Tên hàng</th>
							<th	style="width: 20%">Mô tả</th>
							<th	style="width: 17%">Đơn giá nhập</th>
							<th	style="width: 16%">Đơn giá xuất</th>
							<th	style="width: 5%">Actions</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
				

					</tbody>
				</table>
				
				<!-- 	<div class="clearfix">
				<div class="hint-text">Showing <b>5</b> out of <b>25</b> entries</div>
				<ul class="pagination">
					<li class="page-item disabled"><a href="#">Previous</a></li>
					<li class="page-item"><a href="#" class="page-link">1</a></li>
					<li class="page-item"><a href="#" class="page-link">2</a></li>
					<li class="page-item active"><a href="#" class="page-link">3</a></li>
					<li class="page-item"><a href="#" class="page-link">4</a></li>
					<li class="page-item"><a href="#" class="page-link">5</a></li>
					<li class="page-item"><a href="#" class="page-link">Next</a></li>
				</ul>
			</div>
		</div> -->
			</div>
		</div>
		<div id="addHangHoaModal" class="modal fade">
			<div class="modal-dialog">
				<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">Thêm hàng hóa</h4>
							<button type="button" class="close" data-dismiss="modal"
								aria-hidden="true">&times;</button>
						</div>
						<div class="modal-body">
							<div class="form-group">
								<label>Mã hàng</label> <input type="text" class="form-control" id ="maHH"
									required>
							</div>
							<div class="form-group">
								<label>Tên hàng</label> <input type="text" class="form-control" id ="tenHang"
									required>
							</div>
							<div class="form-group">
								<label>Mô tả</label> <input type="text" class="form-control" id ="mota"  >
							</div>
							<div class="form-group">
								<label>Đơn giá nhập</label> <input type="text" class="form-control" id ="donGiaNhap"  >
							</div>
							<div class="form-group">
								<label>Đơn giá xuất</label> <input type="text" class="form-control" id="donGiaXuat"
									required>
							</div>
							<div class="modal-footer">
							<input type="button" class="btn btn-default" data-dismiss="modal"
								value="Cancel"> <input  type="submit" data-dismiss="modal" data-toggle="modal"
								class="btn btn-success" value="Add" onclick="addHH()">
							</div>
						</div>
				</div>
			</div>
		</div>
		<div id="editHangHoaModal" class="modal fade">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
									<h4 class="modal-title">Edit Accountant</h4>
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true">&times;</button>
								</div>
								<div class="modal-body">
										<div class="form-group">
											<label>Mã hàng</label> <input type="text" class="form-control" id ="emaHH"
												required disabled>
										</div>
										<div class="form-group">
											<label>Tên hàng</label> <input type="text" class="form-control" id ="etenHang"
												required>
										</div>
										<div class="form-group">
											<label>Mô tả</label> <input type="text" class="form-control" id ="emota"  >
										</div>
										<div class="form-group">
											<label>Đơn giá nhập</label> <input type="text" class="form-control" id ="edonGiaNhap"  >
										</div>
										<div class="form-group">
											<label>Đơn giá xuất</label> <input type="text" class="form-control" id="edonGiaXuat"
												required>
										</div>
								</div>
								<div class="modal-footer">
									<input type="button" class="btn btn-default" data-dismiss="modal"
										value="Cancel"> <input  type="submit" data-dismiss="modal"
										class="btn btn-success" value="Save" onclick="updateHH()">
								</div>
						</div>
					</div>
				</div>
		

	
	<script src="https://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
	<script type="text/javascript">	</script>
	<script type="text/javascript"></script>
	<script type="text/javascript">
	function xemHangHoa() {	
		$.ajax({
			type : "POST",
			url : "hanghoa/tatcahanghoa",
			data : {
				thangnam:  $('#thangnam').val() , 
			},
			success : function(result) {
				if (result != null) {
					var dshanghoa= new Array();
					dshanghoa=result;
					$('#listTable tbody').empty();	
					$.each(dshanghoa,function(i, list) {
						var id =  dshanghoa[i].maHH;
						var id1 = id.substr(2,3);
					
						var newRow = '<tr>' 
						    + '<td>' + dshanghoa[i].maHH + '</td>'
						    + '<td>' + dshanghoa[i].tenHang + '</td>'
						    + '<td>' + dshanghoa[i].mota + '</td>'
						    + '<td>' + dshanghoa[i].donGiaNhap+ '</td>'
						    + '<td>' + dshanghoa[i].donGiaXuat+ '</td>'
						    + "<td ><a class='edit' type='submit'  onclick='editHH("+id1+")'>"+"<i  class='material-icons' title='Edit'>"+"&#xE254;</i></a></td>"+ '</tr>';
						    + '</tr>'
						  	$('#listTable tbody').append(newRow); 
						  
					});		
							
					console.log("Success: ", result);
				} else {
					var result = "<h3 style='color:red'> No person found </h3>";
					$("#feedback").html(result);
				}
				
				
			},
			error : function(e) {
				console.log("ERROR: ", e); 
			}
	});
		
	}
	function addHH(){
		console.log(document.getElementById('maHH').value);
		$.ajax({
			type : 'POST',
			url :  "hanghoa/themhanghoa",
			data : {	
				maHH: document.getElementById('maHH').value,
				tenHang: document.getElementById('tenHang').value,
				mota: document.getElementById('mota').value,
				donGiaNhap: document.getElementById('donGiaNhap').value,
				donGiaXuat: document.getElementById('donGiaXuat').value,
			},
			success : function(data) {
				xemHangHoa();
				console.log("SUCCESS: ", data);
			},
			error : function(e) {
				xemHangHoa();
				console.log("ERROR: ", e);
			}
		});
		
	}	
		function editHH(id){	
			var maHH ="HH"+id ;
			$('#editHangHoaModal').modal('show');
			$.ajax({ 
				type : 'GET',
				url :  "hanghoa/edit/"+maHH,
				data: {
					maHH: document.getElementById('emaHH').value,
					tenHang: document.getElementById('etenHang').value,
					mota: document.getElementById('emota').value,
					donGiaNhap: document.getElementById('edonGiaNhap').value,
					donGiaXuat: document.getElementById('edonGiaXuat').value,
				},
				success : function(data) {
					$('#editHangHoaModal #emaHH').val(data.maHH);
					$('#editHangHoaModal #etenHang').val(data.tenHang);
					$('#editHangHoaModal #emota').val(data.mota);
					$('#editHangHoaModal #edonGiaNhap').val(data.donGiaNhap);
					$('#editHangHoaModal #edonGiaXuat').val(data.donGiaXuat);
					xemHangHoa();
					console.log("SUCCESS: ", data);
				},
				error : function(e) {
					console.log("ERROR: ", e);
				}
			});
		}
		function updateHH(){
			$.ajax({
				type : 'PUT',
				url :  "hanghoa/suahanghoa/"+$('#editHangHoaModal #emaHH').val(),
				data : {
					maHH : $('#editHangHoaModal #emaHH').val(),
					tenHang :$('#editHangHoaModal #etenHang').val(),
					mota : $('#editHangHoaModal #emota').val(),
					donGiaNhap : $('#editHangHoaModal #edonGiaNhap').val(),
					donGiaXuat : $('#editHangHoaModal #edonGiaXuat').val(),
				},
				success : function(data) {
					xemHangHoa();
					console.log("SUCCESS: ", data);
				},
				error : function(e) {
					xemHangHoa();
					console.log("ERROR: ", e);
				}
			});
		}
		function searchHH() {
			var id = $('#search').val();
			var name = $('#search').val();
		
			$.ajax({
					type : "GET",
					data : {
						maHH: id,
						tenHang: name,
					},				
					url : "hanghoa/timhanghoa",	
					
					success : function(result) {
						var dshanghoa= new Array();
						dshanghoa=result;
						$('#listTable tbody').empty();	
						for(var i=0; i<dshanghoa.length;i++) {
							var id =  dshanghoa[i].maHH;
							var id1 = id.substr(2,3);
							var newRow = '<tr>' 
							    + '<td>' + dshanghoa[i].maHH + '</td>'
							    + '<td>' + dshanghoa[i].tenHang + '</td>'
							    + '<td>' + dshanghoa[i].mota + '</td>'
							    + '<td>' + dshanghoa[i].donGiaNhap+ '</td>'
							    + '<td>' + dshanghoa[i].donGiaXuat+ '</td>'
							    + "<td ><a class='edit' type='submit'  onclick='editHH("+id1+")'>"+"<i  class='material-icons' title='Edit'>"+"&#xE254;</i></a></td>"+ '</tr>';
							    + '</tr>'
							  	$('#listTable tbody').append(newRow);
						}
					},
					error : function(e) {
						console.log("ERROR: ", e);
					}
				});
		}
	</script>
</body>
</html>